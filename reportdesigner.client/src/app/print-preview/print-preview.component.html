<div class="print-preview-container">
  <div class="top-toolbar">
    <div class="export-dropdown">
      <button class="export-button">Export As</button>
      <div class="export-dropdown-content">
        <button (click)="exportDivToHtml()">HTML</button>
        <button >PDF</button>
        <button >Image</button>
        <button >Email</button>
      </div>
    </div>
    <br>
    <button styleSheetFile="assets/style.css" printSectionId="printable-section" ngxPrint>Print</button><br>
  </div>
    <div class="report-container" id="printable-section" #exportedDiv>
      <div class="top-section">
        <!-- Image and title -->
        <div class="image-and-title">
          <img *ngIf="logoDataURL" [src]="logoDataURL" alt="Report Logo" class="report-logo"/>
          <h1>{{reportTitle}}</h1>
        </div>
        <!-- Current date/time -->
        <div class="date-time">
          <p>{{ currentDate }}</p>
          <p>{{ currentTime }}</p>
        </div>
      </div>
        <div class="table-container">
          <ng-container *ngFor="let tableSelection of tableSelections">
            <h2>{{ tableSelection.database }}</h2>
            <h3>{{ tableSelection.table }}</h3>
            <!-- Include the table rendering code here -->
            <table class="tbl-data">
              <thead>
                <tr>
                  <!-- Include table headers here -->
                  <th *ngFor="let header of getTableHeaders(tableSelection.database, tableSelection.table); let z = index">
                    <div class="table-header">{{ header }}</div>
                  </th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let row of getTableData(tableSelection.database, tableSelection.table); let i = index">
                  <!-- Include table cells here -->
                  <td *ngFor="let cell of row | keyvalue; let j = index" class="cell-content" [ngStyle]="applyStyle(i,tableSelection.database + '-' + tableSelection.table + '-' + j)" [attr.data-row]="i" [attr.data-col]="cell.key">
                  {{ cell.value }}
                  </td>
                </tr>
              </tbody>
            </table>
          </ng-container>
        </div>
      </div>
</div>